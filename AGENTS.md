# Repository Guidelines

## Project Structure & Module Organization

- `app/` contains runnable targets; `app/poc/` is the current CLI entrypoint that depends on the core library.
- `lib/` hosts reusable modules. Headers live beside their implementations (for example `lib/core/poc/core.hpp|cpp`) and expose public include paths through xmake.
- `tests/` mirrors the library layout: unit suites under `tests/unit`, shared fixtures in `tests/.utility`, plus reserved stubs for benchmark and fuzz targets.
- `build/` is generated by xmake (compile commands, caches, artifacts). Keep it out of commits and reset with `xmake clean` when builds misbehave.
- `docker/` and `.github/` hold container and CI assets; sync with maintainers before changing automation.

## Build, Test, and Development Commands

- `xmake f -m debug -y` configures the project for debug builds (use `release` or `coverage` as needed).
- `xmake build poc` (or plain `xmake`) compiles all enabled targets.
- `xmake run poc` launches the analyzer binary with the current configuration.
- `xmake test poc.core.tests.unit` runs doctest-based unit tests; append `junit` to emit `build/poc.core.tests.unit.junit.xml`.
- `pre-commit run --all-files` enforces clang-format before pushing.

## Coding Style & Naming Conventions

- Follow `.clang-format` (LLVM toolchain, 4-space indentation, aligned trailing comments). Run `clang-format -style=file -i` on touched C++ files.
- Prefer trailing return types and `auto` for function signatures (`auto main() -> int`).
- File and directory names use `snake_case`; macros remain `UPPER_SNAKE_CASE`.
- Order includes as: standard library, third-party, then project headers. Tests insert `doctest/doctest.h` first, followed by the header under test.
- Keep namespaces small and close with a comment (`} // namespace poc`), matching the existing pattern.

## Testing Guidelines

- Unit tests rely on [doctest]; add new suites under the mirrored path in `tests/unit`.
- Register new binaries with `add_tests` so they run via `xmake test`; provide a JUnit variant when practical for CI artifacts.
- For coverage, configure with `xmake f -m coverage -y`, rebuild, then rerun tests. Target edge cases from live item data (rarity tiers, affix rolls).

## Commit & Pull Request Guidelines

- Use Conventional Commit messages (`feat`, `fix`, `test`, etc.), optionally scoping (`feat(parser): ...`). Mark breaking API shifts with `!` or a `BREAKING CHANGE` footer.
- Each PR should summarize intent, list key changes, reference related issues, and show test commands or rationale for skips.
- Keep diffs focused: update docs and tests with code and note any follow-up work separately.
